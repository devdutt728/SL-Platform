@echo off
set "ROOT=D:\SL Platform"
set "LOGDIR=%ROOT%\logs"
if not exist "%LOGDIR%" mkdir "%LOGDIR%"

title SLP Live Logs

powershell -NoExit -Command "& { $logDir = '%LOGDIR%'; $streams = @(@{Name='IT-BACKEND';File=Join-Path $logDir 'it-backend.log';Color='Cyan'},@{Name='IT-BACKEND-ERR';File=Join-Path $logDir 'it-backend.err.log';Color='Red'},@{Name='REC-BACKEND';File=Join-Path $logDir 'recruitment-backend.log';Color='Magenta'},@{Name='REC-BACKEND-ERR';File=Join-Path $logDir 'recruitment-backend.err.log';Color='Red'},@{Name='IT-FRONTEND';File=Join-Path $logDir 'it-frontend.log';Color='Green'},@{Name='REC-FRONTEND';File=Join-Path $logDir 'recruitment-frontend.log';Color='Green'},@{Name='WORKBOOK';File=Join-Path $logDir 'workbook-frontend.log';Color='Yellow'},@{Name='CADDY';File=Join-Path $logDir 'caddy.log';Color='Blue'},@{Name='CADDY-ERR';File=Join-Path $logDir 'caddy.err.log';Color='Red'}); foreach ($s in $streams) { if (-not (Test-Path $s.File)) { New-Item -ItemType File -Force -Path $s.File | Out-Null } }; Write-Host 'Studio Lotus Platform - Live Logs' -ForegroundColor White; Write-Host 'Press Ctrl+C to close.' -ForegroundColor DarkGray; $readers = @(); foreach ($s in $streams) { $fs = [System.IO.File]::Open($s.File, [System.IO.FileMode]::Open, [System.IO.FileAccess]::Read, [System.IO.FileShare]::ReadWrite); $sr = New-Object System.IO.StreamReader($fs); $sr.BaseStream.Seek(0, [System.IO.SeekOrigin]::End) | Out-Null; $readers += @{ Stream = $s; Reader = $sr } }; while ($true) { foreach ($entry in $readers) { $stream = $entry.Stream; $reader = $entry.Reader; while (-not $reader.EndOfStream) { $line = $reader.ReadLine(); if ($null -ne $line) { $ts = (Get-Date).ToString('HH:mm:ss'); Write-Host "[$ts][$($stream.Name)] $line" -ForegroundColor $stream.Color } } }; Start-Sleep -Milliseconds 250 } }"
